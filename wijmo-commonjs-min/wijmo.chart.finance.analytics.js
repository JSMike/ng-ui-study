/*
    *
    * Wijmo Library 5.20171.282
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
"use strict";function isValid(n){return isFinite(n)&&!isNaN(n)&&wjcCore.isNumber(n)}function _cci(n,t,i,r,u){var l;wjcCore.asArray(n,!1);wjcCore.asArray(t,!1);wjcCore.asArray(i,!1);wjcCore.asInt(r,!1,!0);wjcCore.asNumber(u,!1,!0);var s=wjcChartFinance._minimum(n.length,t.length,i.length),e=[],h=[],o,f,c=[];for(wjcCore.assert(s>r&&r>1,"CCI period must be an integer less than the length of the data and greater than one."),f=0;f<s;f++)e.push(wjcChartFinance._average(n[f],t[f],i[f]));for(o=wjcChartFinance._sma(e,r),f=0;f<o.length;f++)l=e.slice(f,r+f).reduce(function(n,t){return n+Math.abs(o[f]-t)},0),h.push(l/r);for(e.splice(0,r-1),f=0;f<o.length;f++)c.push((e[f]-o[f])/(u*h[f]));return c}function _williamsR(n,t,i,r){wjcCore.asArray(n,!1);wjcCore.asArray(t,!1);wjcCore.asArray(i,!1);wjcCore.asInt(r,!1,!0);var s=wjcChartFinance._minimum(n.length,t.length,i.length),f=[],e=[],o=[],u;for(wjcCore.assert(s>r&&r>1,"Williams %R period must be an integer less than the length of the data and greater than one."),u=r;u<=n.length;u++)f.push(wjcChartFinance._maximum(n.slice(u-r,u))),e.push(wjcChartFinance._minimum(t.slice(u-r,u)));for(i.splice(0,r-1),u=0;u<f.length;u++)o.push((f[u]-i[u])/(f[u]-e[u])*-100);return o}function _bollingerBands(n,t,i){var u,f,r;for(wjcCore.asArray(n,!1),wjcCore.asInt(t,!1,!0),wjcCore.asNumber(i,!1,!0),wjcCore.assert(n.length>t&&t>1,"Bollinger Bands period must be an integer less than the length of the data and greater than one."),u=wjcChartFinance._sma(n,t),f=[],r=t;r<=n.length;r++)f.push(wjcChartFinance._stdDeviation(n.slice(r-t,r)));var e=u,o=u.map(function(n,t){return n+f[t]*i}),s=u.map(function(n,t){return n-f[t]*i});return{lowers:s,middles:e,uppers:o}}function _rsi(n,t){wjcCore.asArray(n,!1);wjcCore.asInt(t,!0,!1);wjcCore.assert(n.length>t&&t>1,"RSI period must be an integer less than the length of the data and greater than one.");for(var u=[],f=[],e=[],o,s,h=[],r,i=1;i<n.length;i++)u.push(n[i]-n[i-1]);for(o=u.map(function(n){return n>0?n:0}),s=u.map(function(n){return n<0?Math.abs(n):0}),i=t;i<=u.length;i++)i===t?(f.push(wjcChartFinance._sum(o.slice(i-t,i))/t),e.push(wjcChartFinance._sum(s.slice(i-t,i))/t)):(f.push((o[i-1]+f[i-t-1]*(t-1))/t),e.push((s[i-1]+e[i-t-1]*(t-1))/t)),r=f[i-t]/e[i-t],r=isFinite(r)?r:0,h.push(100-100/(1+r));return h}function _macd(n,t,i,r){var s,e,c;wjcCore.asArray(n,!1);wjcCore.asInt(t,!1,!0);wjcCore.asInt(i,!1,!0);wjcCore.asInt(r,!1,!0);s=t>i;s&&(e=i,i=t,t=e);var h=wjcChartFinance._ema(n,t),a=wjcChartFinance._ema(n,i),f=[],l=[],o,u;for(h.splice(0,i-t),u=0;u<h.length;u++)e=h[u]-a[u],s&&(e*=-1),f.push(e);for(o=wjcChartFinance._ema(f,r),c=f.slice(f.length-o.length,f.length),u=0;u<c.length;u++)l.push(c[u]-o[u]);return{macds:f,signals:o,histograms:l}}function _stochastic(n,t,i,r,u,f){wjcCore.asArray(n,!1);wjcCore.asArray(t,!1);wjcCore.asArray(i,!1);wjcCore.asInt(r,!1,!0);wjcCore.asInt(u,!1,!0);wjcCore.asInt(f,!0,!0);for(var h=[],s=[],o=[],c,e=r;e<=n.length;e++)h.push(wjcChartFinance._maximum(n.slice(e-r,e))),s.push(wjcChartFinance._minimum(t.slice(e-r,e)));for(i=i.slice(r-1),e=0;e<i.length;e++)o.push((i[e]-s[e])/(h[e]-s[e])*100);return f&&f>1&&(o=wjcChartFinance._sma(o,f)),c=wjcChartFinance._sma(o,u),{ks:o,ds:c}}var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},wjcCore=require('wijmo/wijmo'),wjcChart=require('wijmo/wijmo.chart'),wjcChartFinance=require('wijmo/wijmo.chart.finance'),wjcSelf=require('wijmo/wijmo.chart.finance.analytics'),Fibonacci,FibonacciArcs,FibonacciFans,FibonacciTimeZones,OverlayIndicatorBase,SingleOverlayIndicatorBase,ATR,CCI,WilliamsR,MovingAverageType,Envelopes,BollingerBands,RSI,MacdBase,Macd,MacdHistogram,Stochastic;window.wijmo=window.wijmo||{};window.wijmo.chart=window.wijmo.chart||{};window.wijmo.chart.finance=window.wijmo.chart.finance||{};window.wijmo.chart.finance.analytics=wjcSelf;Fibonacci=function(n){function t(t){n.call(this);this._levels=[0,23.6,38.2,50,61.8,100];this._uptrend=!0;this._labelPosition=wjcChart.LabelPosition.Left;t&&wjcCore.copy(this,t);this.rendering.addHandler(this._render)}return __extends(t,n),Object.defineProperty(t.prototype,"low",{get:function(){return this._low},set:function(n){n!=this._low&&(this._low=wjcCore.asNumber(n,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"high",{get:function(){return this._high},set:function(n){n!=this._high&&(this._high=wjcCore.asNumber(n,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(n){n!=this._labelPosition&&(this._labelPosition=wjcCore.asEnum(n,wjcChart.LabelPosition,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uptrend",{get:function(){return this._uptrend},set:function(n){n!=this._uptrend&&(this._uptrend=wjcCore.asBoolean(n,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levels",{get:function(){return this._levels},set:function(n){n!=this._levels&&(this._levels=wjcCore.asArray(n,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},set:function(n){n!=this._minX&&(this._minX=n,this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},set:function(n){n!=this._maxX&&(this._maxX=n,this._invalidate())},enumerable:!0,configurable:!0}),t.prototype._getMinX=function(){return wjcCore.isNumber(this._minX)?this._minX:wjcCore.isDate(this._minX)?wjcCore.asDate(this._minX).valueOf():this._getAxisX().actualMin},t.prototype._getMaxX=function(){return wjcCore.isNumber(this._maxX)?this._maxX:wjcCore.isDate(this._maxX)?wjcCore.asDate(this._maxX).valueOf():this._getAxisX().actualMax},t.prototype._updateLevels=function(){var r=undefined,u=undefined,f,e,t,i,o;if((this._low===undefined||this._high===undefined)&&(f=n.prototype.getValues.call(this,0),e=n.prototype.getValues.call(this,1),f)){var s=f.length,h=this._getMinX(),c=this._getMaxX();for(t=0;t<s;t++)(i=f[t],o=e?e[t]:t,o<h||o>c)||isNaN(i)||((r===undefined||r>i)&&(r=i),(u===undefined||u<i)&&(u=i))}this._actualLow=this._low===undefined&&r!==undefined?r:this._low;this._actualHigh=this._high===undefined&&u!==undefined?u:this._high},t.prototype._render=function(n,t){var i,s,h,y,f,a,o;t.cancel=!0;i=n;i._updateLevels();var u=i._getAxisX(),w=i._getAxisY(),r=t.engine,b=i._getSymbolStroke(i._chart.series.indexOf(i)),k=wjcChart._BasePlotter.cloneStyle(i.style,['fill']),v=wjcChart._BasePlotter.cloneStyle(i.style,['stroke']),d=i.chart._plotrectId;for(r.stroke=b,r.strokeWidth=2,r.textFill=b,s=i._getMinX(),h=i._getMaxX(),s<u.actualMin&&(s=u.actualMin),h>u.actualMax&&(h=u.actualMax),r.startGroup(null,d),y=i._levels?i._levels.length:0,f=0;f<y;f++){var p=i._levels[f],c=u.convert(s),l=u.convert(h),e=i.uptrend?w.convert(i._actualLow+.01*p*(i._actualHigh-i._actualLow)):w.convert(i._actualHigh-.01*p*(i._actualHigh-i._actualLow));if(wjcChart._DataInfo.isValid(c)&&wjcChart._DataInfo.isValid(l)&&wjcChart._DataInfo.isValid(e)&&(r.drawLine(c,e,l,e,null,k),i.labelPosition!=wjcChart.LabelPosition.None)){a=p.toFixed(1)+'%';o=0;(i.uptrend&&f==0||!i.uptrend&&f==y-1)&&(o=2);switch(i.labelPosition){case wjcChart.LabelPosition.Left:wjcChart.FlexChartCore._renderText(r,a,new wjcCore.Point(c,e),0,o,null,null,v);break;case wjcChart.LabelPosition.Center:wjcChart.FlexChartCore._renderText(r,a,new wjcCore.Point(.5*(c+l),e),1,o,null,null,v);break;case wjcChart.LabelPosition.Right:wjcChart.FlexChartCore._renderText(r,a,new wjcCore.Point(l,e),2,o,null,null,v)}}}r.stroke=null;r.strokeWidth=null;r.textFill=null;r.endGroup()},t.prototype._getChartType=function(){return wjcChart.ChartType.Line},t}(wjcChart.SeriesBase);exports.Fibonacci=Fibonacci;FibonacciArcs=function(n){function t(t){n.call(this);this._levels=[38.2,50,61.8];this._labelPosition=wjcChart.LabelPosition.Top;t&&wjcCore.copy(this,t);this.rendering.addHandler(this._render,this)}return __extends(t,n),Object.defineProperty(t.prototype,"start",{get:function(){return this._start},set:function(n){n!==this.start&&(this._start=wjcCore.asType(n,wjcChart.DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._end},set:function(n){n!==this.end&&(this._end=wjcCore.asType(n,wjcChart.DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levels",{get:function(){return this._levels},set:function(n){n!==this._levels&&(this._levels=wjcCore.asArray(n,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(n){n!==this.labelPosition&&(this._labelPosition=wjcCore.asEnum(n,wjcChart.LabelPosition),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype._render=function(t,i){var rt,c,k,p,l,ut,f,a,w,v,d,b;i.cancel=!0;var y=this._getX(0),e=this._getY(0),o=this._getX(1),u=this._getY(1);if(!(n.prototype._getLength.call(this)<=1)&&isValid(y)&&isValid(e)&&isValid(o)&&isValid(u)){var s=this._getAxisX(),h=this._getAxisY(),r=i.engine,g,ft=this.chart.series.indexOf(this),nt=this._getSymbolStroke(ft),tt=wjcChart._BasePlotter.cloneStyle(this.style,["fill"]),it=wjcChart._BasePlotter.cloneStyle(this.style,["stroke"]);for(r.stroke=nt,r.strokeWidth=2,r.textFill=nt,rt=this.chart._plotrectId,c=u-e,g=r.startGroup(null,rt),wjcCore.addClass(g,'fibonacci-arcs'),isValid(y)&&isValid(e)&&isValid(o)&&isValid(u)&&r.drawLines([s.convert(y),s.convert(o)],[h.convert(e),h.convert(u)],null,tt),ut=Math.sqrt(Math.pow(s.convert(o)-s.convert(y),2)+Math.pow(h.convert(u)-h.convert(e),2)),a=new wjcCore.Point(o,u),b=0;b<this.levels.length;b++)if(w=this.levels[b]*.01,f=Math.abs(ut*w),isValid(a.x)&&isValid(a.y)&&isValid(f)&&(k=s.convert(a.x),p=h.convert(a.y),r.drawDonutSegment(k,p,f,f,c>0?0:Math.PI,Math.PI,null,tt),this.labelPosition!==wjcChart.LabelPosition.None&&w!==0)){d=wjcCore.Globalize.format(w,"p1");v=r.measureString(d,null,null,it);l=c<=0?p-f:p+f;switch(this.labelPosition){case wjcChart.LabelPosition.Center:l+=v.height*.5;break;case wjcChart.LabelPosition.Bottom:l+=c<=0?v.height:0;break;default:l+=c<=0?0:v.height}r.drawString(d,new wjcCore.Point(k-v.width*.5,l),null,it)}r.stroke=null;r.strokeWidth=null;r.textFill=null;r.endGroup()}},t.prototype._getX=function(n){var t=null;return n===0&&this.start?t=this.start.x:n===1&&this.end&&(t=this.end.x),wjcCore.isDate(t)&&(t=wjcCore.asDate(t).valueOf()),t},t.prototype._getY=function(n){var t=null;return n===0&&this.start?t=this.start.y:n===1&&this.end&&(t=this.end.y),t},t.prototype._getChartType=function(){return wjcChart.ChartType.Line},t}(wjcChart.SeriesBase);exports.FibonacciArcs=FibonacciArcs;FibonacciFans=function(n){function t(t){n.call(this);this._levels=[0,23.6,38.2,50,61.8,100];this._labelPosition=wjcChart.LabelPosition.Top;t&&wjcCore.copy(this,t);this.rendering.addHandler(this._render,this)}return __extends(t,n),Object.defineProperty(t.prototype,"start",{get:function(){return this._start},set:function(n){n!==this.start&&(this._start=wjcCore.asType(n,wjcChart.DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._end},set:function(n){n!==this.end&&(this._end=wjcCore.asType(n,wjcChart.DataPoint),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levels",{get:function(){return this._levels},set:function(n){n!==this._levels&&(this._levels=wjcCore.asArray(n,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(n){n!==this.labelPosition&&(this._labelPosition=wjcCore.asEnum(n,wjcChart.LabelPosition),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype._updateLevels=function(){if(!this.start||!this.end){var s=this.chart._getPlotter(this),o=this._getAxisX(),t=n.prototype.getValues.call(this,0),i=n.prototype.getValues.call(this,1)||s.dataInfo.getXVals(),r,u,f,e;t&&t.length>0&&(f=wjcChartFinance._minimum(t),e=wjcChartFinance._maximum(t));i&&i.length>0?(r=wjcChartFinance._minimum(i),u=wjcChartFinance._maximum(i)):(r=o.actualMin,u=o.actualMax);isValid(r)&&isValid(f)&&isValid(u)&&isValid(e)&&(this.start=new wjcChart.DataPoint(r,f),this.end=new wjcChart.DataPoint(u,e))}},t.prototype._render=function(t,i){var wt,ft;i.cancel=!0;this._updateLevels();var ht=this._getX(0),ct=this._getY(0),lt=this._getX(1),at=this._getY(1);if(!(n.prototype._getLength.call(this)<=1)&&isValid(ht)&&isValid(ct)&&isValid(lt)&&isValid(at)){var o=this._getAxisX(),e=this._getAxisY(),dt=this.chart.series.indexOf(this),y=i.engine,bt=this._getSymbolStroke(dt),gt=wjcChart._BasePlotter.cloneStyle(this.style,["fill"]),vt=wjcChart._BasePlotter.cloneStyle(this.style,["stroke"]);y.stroke=bt;y.strokeWidth=2;y.textFill=bt;var k=at-ct,tt=lt-ht,ni=this.chart._plotrectId,it,w,d,v,g,c,yt,a,p,pt,rt,r,ut;for(it=ht,d=ct,w=lt,v=at,wt=w,y.startGroup(null,ni),ft=0;ft<this.levels.length;ft++)if(w=tt<0?o.actualMin:o.actualMax,pt=this.levels[ft]*.01,v=d+pt*k,a=(v-d)/(wt-it),p=v-a*wt,v=a*w+p,k>0&&v>e.actualMax?(v=e.actualMax,w=(v-p)/a):k<0&&v<e.actualMin&&(v=e.actualMin,w=(v-p)/a),isValid(it)&&isValid(d)&&isValid(w)&&isValid(v)&&(g=new wjcCore.Point(o.convert(it),e.convert(d)),c=new wjcCore.Point(o.convert(w),e.convert(v)),y.drawLines([g.x,c.x],[g.y,c.y],null,gt),this.labelPosition!=wjcChart.LabelPosition.None)){rt=wjcCore.Globalize.format(pt,"p1");r=y.measureString(rt,null,null,vt);ut=Math.atan((c.y-g.y)/(c.x-g.x))*180/Math.PI;yt=c.clone();c.x=tt>0?c.x-r.width:c.x;var u=ut*Math.PI/180,f=new wjcCore.Point,h=new wjcCore.Point,l=new wjcCore.Point,s=new wjcCore.Point,et=e.convert(e.actualMin),kt=e.convert(e.actualMax),ot=o.convert(o.actualMin),st=o.convert(o.actualMax),b,nt=yt.clone();switch(this.labelPosition){case wjcChart.LabelPosition.Center:c.y+=r.height*.5;nt.y+=r.height*.5;break;case wjcChart.LabelPosition.Bottom:c.y+=r.height}tt>0?(this.labelPosition===wjcChart.LabelPosition.Top||this.labelPosition===wjcChart.LabelPosition.Center?(s=nt.clone(),l.x=s.x+r.height*Math.sin(u),l.y=s.y-r.height*Math.cos(u),f.x=s.x-r.width*Math.cos(u)+r.height*Math.sin(u),f.y=s.y-r.width*Math.sin(u)-r.height*Math.cos(u),h.x=s.x-r.width*Math.cos(u),h.y=s.y-r.width*Math.sin(u)):this.labelPosition===wjcChart.LabelPosition.Bottom&&(l=nt.clone(),f.x=l.x-r.width*Math.cos(u),f.y=l.y-r.width*Math.sin(u),h.x=f.x-r.height*Math.sin(u),h.y=f.y+r.height*Math.cos(u),s.x=f.x+r.width*Math.cos(u)-r.height*Math.sin(u),s.y=f.y+r.width*Math.sin(u)+r.height*Math.cos(u)),k>0?(l.y<kt&&(a=(e.convertBack(l.y)-e.convertBack(f.y))/(o.convertBack(l.x)-o.convertBack(f.x)),p=e.convertBack(l.y)-a*o.convertBack(l.x),b=o.convert((e.actualMax-p)/a),c.x-=Math.abs(l.x-b)),s.x>st&&(c.x-=Math.abs(st-s.x))):k<0&&(s.y>et&&(a=(e.convertBack(h.y)-e.convertBack(s.y))/(o.convertBack(h.x)-o.convertBack(s.x)),p=e.convertBack(s.y)-a*o.convertBack(s.x),b=o.convert((e.actualMin-p)/a),c.x-=Math.max(Math.abs(b-s.x),Math.abs(et-s.y))),l.x>st&&(c.x-=Math.abs(st-l.x)))):tt<0&&(this.labelPosition===wjcChart.LabelPosition.Top||this.labelPosition===wjcChart.LabelPosition.Center?(h=nt.clone(),f.x=h.x+r.height*Math.sin(u),f.y=h.y-r.height*Math.cos(u),s.x=h.x+r.width*Math.cos(u),s.y=h.y+r.width*Math.sin(u),l.x=f.x+r.width*Math.cos(u),l.y=f.y+r.width*Math.sin(u)):this.labelPosition===wjcChart.LabelPosition.Bottom&&(f=nt.clone(),l.x=f.x+r.width*Math.cos(u),l.y=f.y+r.width*Math.sin(u),h.x=f.x-r.height*Math.sin(u),h.y=f.y+r.height*Math.cos(u),s.x=f.x+r.width*Math.cos(u)-r.height*Math.sin(u),s.y=f.y+r.width*Math.sin(u)+r.height*Math.cos(u)),k>0?(f.y<kt&&(a=(e.convertBack(f.y)-e.convertBack(l.y))/(o.convertBack(f.x)-o.convertBack(l.x)),p=e.convertBack(f.y)-a*o.convertBack(f.x),b=o.convert((e.actualMax-p)/a),c.x+=Math.abs(f.x-b)),h.x<ot&&(c.x+=Math.abs(ot-h.x))):k<0&&(h.y>et&&(a=(e.convertBack(s.y)-e.convertBack(h.y))/(o.convertBack(s.x)-o.convertBack(h.x)),p=e.convertBack(h.y)-a*o.convertBack(h.x),b=o.convert((e.actualMin-p)/a),c.x+=Math.max(Math.abs(b-h.x),Math.abs(et-h.y))),f.x<ot&&(c.x+=Math.abs(ot-f.x))));ut===0?y.drawString(rt,c,null,vt):y.drawStringRotated(rt,c,yt,ut,null,vt)}y.stroke=null;y.strokeWidth=null;y.textFill=null;y.endGroup()}},t.prototype._getX=function(n){var t=null;return n===0&&this.start?t=this.start.x:n===1&&this.end&&(t=this.end.x),wjcCore.isDate(t)&&(t=wjcCore.asDate(t).valueOf()),t},t.prototype._getY=function(n){var t=null;return n===0&&this.start?t=this.start.y:n===1&&this.end&&(t=this.end.y),t},t.prototype._getChartType=function(){return wjcChart.ChartType.Line},t}(wjcChart.SeriesBase);exports.FibonacciFans=FibonacciFans;FibonacciTimeZones=function(n){function t(t){n.call(this);this._levels=[0,1,2,3,5,8,13,21,34];this._labelPosition=wjcChart.LabelPosition.Right;t&&wjcCore.copy(this,t);this.rendering.addHandler(this._render,this)}return __extends(t,n),Object.defineProperty(t.prototype,"startX",{get:function(){return this._startX},set:function(n){n!==this.startX&&(this._startX=wjcCore.isDate(n)?wjcCore.asDate(n):wjcCore.asNumber(n),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endX",{get:function(){return this._endX},set:function(n){n!==this.endX&&(this._endX=wjcCore.isDate(n)?wjcCore.asDate(n):wjcCore.asNumber(n),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levels",{get:function(){return this._levels},set:function(n){n!==this._levels&&(this._levels=wjcCore.asArray(n,!1),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelPosition",{get:function(){return this._labelPosition},set:function(n){n!==this.labelPosition&&(this._labelPosition=wjcCore.asEnum(n,wjcChart.LabelPosition),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype._render=function(t,i){var e,c,h;if(i.cancel=!0,this._updateLevels(),e=this._getX(0),c=this._getX(1),!(n.prototype._getLength.call(this)<=1)&&isValid(e)&&isValid(c)){var l=c-e,a=this._getAxisX(),o=this._getAxisY(),k=this._chart.series.indexOf(this),u=i.engine,f=2,p=this._getSymbolStroke(k),d=wjcChart._BasePlotter.cloneStyle(this.style,["fill"]),w=wjcChart._BasePlotter.cloneStyle(this.style,["stroke"]),b=o.convert(o.actualMin),g=o.convert(o.actualMax),v,r,s,y,nt=this.chart._plotrectId;if(u.stroke=p,u.strokeWidth=f,u.textFill=p,l!==0){for(u.startGroup(null,nt),h=0;h<this.levels.length;h++)if((v=this.levels[h],r=l*v+e,!(r<a.actualMin)&&!(a.actualMax<r)&&isValid(r))&&(r=a.convert(r),u.drawLine(r,b,r,g,null,d),this.labelPosition!==wjcChart.LabelPosition.None)){y=wjcCore.Globalize.format(v,"n0");s=u.measureString(y,null,null,w);switch(this.labelPosition){case wjcChart.LabelPosition.Left:r-=s.width+f;break;case wjcChart.LabelPosition.Center:r-=s.width/2;break;case wjcChart.LabelPosition.Right:r+=f;break;default:r=l<0?r-s.width-f:r+f}u.drawString(y,new wjcCore.Point(r,b),null,w)}u.stroke=null;u.strokeWidth=null;u.textFill=null;u.endGroup()}}},t.prototype._updateLevels=function(){var r=this.chart._getPlotter(this),t=n.prototype.getValues.call(this,1)||r.dataInfo.getXVals();if(!(n.prototype._getLength.call(this)<=1)){var u=this._getX(0),f=this._getX(1),i=wjcCore.isNumber(u)&&wjcCore.isNumber(f);i||t?!i&&t&&(this._startX=t[0],this._endX=t[1]):(this._startX=0,this._endX=1)}},t.prototype._getX=function(n){var t=null;return n===0?t=this.startX:n===1&&(t=this.endX),wjcCore.isDate(t)&&(t=wjcCore.asDate(t).valueOf()),t},t.prototype._getChartType=function(){return wjcChart.ChartType.Line},t}(wjcChart.SeriesBase);exports.FibonacciTimeZones=FibonacciTimeZones;OverlayIndicatorBase=function(n){function t(){n.call(this);this._seriesCount=1}return __extends(t,n),Object.defineProperty(t.prototype,"_hitTester",{get:function(){return this._plotter&&!this.__hitTester&&(this.__hitTester=this._plotter.hitTester),this.__hitTester},enumerable:!0,configurable:!0}),t.prototype._getChartType=function(){return wjcChart.ChartType.Line},t.prototype._getXValues=function(){return n.prototype.getValues.call(this,1)||this._plotter.dataInfo.getXVals()},t.prototype._getDataPoint=function(n,t,i,r,u,f){var e=new wjcChart._DataPoint(i,r,n,t);return e.y=t,e.yfmt=f._formatValue(t),e.x=n,e.xfmt=u._formatValue(n),e},t.prototype._shouldCalculate=function(){return!0},t.prototype._init=function(){},t.prototype._calculate=function(){},t.prototype._clearValues=function(){n.prototype._clearValues.call(this);this.__hitTester=null},t.prototype._getName=function(n){var i=undefined,t;return this.name&&(this.name.indexOf(",")?(t=this.name.split(","),t&&t.length-1>=n&&(i=t[n].trim())):i=this.name),i},t.prototype._getStyles=function(n){var t=null,i,r;if(n<0||this._styles===null)return t;i=0;for(r in this._styles){if(i===n&&this._styles.hasOwnProperty(r)){t=this._styles[r];break}i++}return t},t.prototype.legendItemLength=function(){return this._seriesCount},t.prototype.measureLegendItem=function(n,t){var r=this._getName(t),i=new wjcCore.Size(0,0);return r&&(i=this._measureLegendItem(n,this._getName(t))),i},t.prototype.drawLegendItem=function(n,t,i){var r=this._getStyles(i)||this.style,u=this._getName(i);u&&this._drawLegendItem(n,t,this._getChartType(),this._getName(i),r,this.symbolStyle)},t}(wjcChart.SeriesBase);exports.OverlayIndicatorBase=OverlayIndicatorBase;SingleOverlayIndicatorBase=function(n){function t(){n.call(this);this._period=14}return __extends(t,n),Object.defineProperty(t.prototype,"period",{get:function(){return this._period},set:function(n){n!==this._period&&(this._period=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype.getValues=function(t){var i=null;return n.prototype._getLength.call(this)<=0?i:(this._shouldCalculate()&&(this._init(),this._calculate()),t===0?i=this._yvals:t===1&&(i=this._xvals),i)},t.prototype.getDataRect=function(t,i){var r;if(i)return i;if(r=null,n.prototype._getLength.call(this)<=0)return r;this._shouldCalculate()&&(this._init(),this._calculate());var u=wjcChartFinance._minimum(this._xvals),e=wjcChartFinance._maximum(this._xvals),f=wjcChartFinance._minimum(this._yvals),o=wjcChartFinance._maximum(this._yvals);return wjcChart._DataInfo.isValid(u)&&wjcChart._DataInfo.isValid(e)&&wjcChart._DataInfo.isValid(f)&&wjcChart._DataInfo.isValid(o)&&(r=new wjcCore.Rect(u,f,e-u,o-f)),r},t.prototype._clearValues=function(){n.prototype._clearValues.call(this);this._xvals=null;this._yvals=null},t.prototype._shouldCalculate=function(){return!this._yvals||!this._xvals},t.prototype._init=function(){n.prototype._init.call(this);this._yvals=[];this._xvals=[]},t.prototype._getItem=function(t){if(n.prototype._getLength.call(this)<=0)return n.prototype._getItem.call(this,t);this._shouldCalculate()&&(this._init(),this._calculate());var i=n.prototype._getLength.call(this),r=wjcChartFinance._minimum(this._yvals.length,this._xvals.length);return t=i-r+t,n.prototype._getItem.call(this,t)},t}(OverlayIndicatorBase);exports.SingleOverlayIndicatorBase=SingleOverlayIndicatorBase;ATR=function(n){function t(){n.call(this);this.period=14}return __extends(t,n),t.prototype._calculate=function(){if(!(n.prototype._getLength.call(this)<=0)){var t=n.prototype._getBindingValues.call(this,0),r=n.prototype._getBindingValues.call(this,1),u=n.prototype._getBindingValues.call(this,3),i=this._getXValues();this._yvals=wjcChartFinance._avgTrueRng(t,r,u,this.period);this._xvals=i?i.slice(this.period-1):wjcChartFinance._range(this.period-1,t.length)}},t}(SingleOverlayIndicatorBase);exports.ATR=ATR;CCI=function(n){function t(){n.call(this);this._constant=.015;this.period=20}return __extends(t,n),Object.defineProperty(t.prototype,"constant",{get:function(){return this._constant},set:function(n){n!==this._constant&&(this._constant=wjcCore.asNumber(n,!1),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype._calculate=function(){var t=n.prototype._getLength.call(this);if(!(t<=0)){var r=n.prototype._getBindingValues.call(this,0),u=n.prototype._getBindingValues.call(this,1),f=n.prototype._getBindingValues.call(this,3),i=this._getXValues();this._yvals=_cci(r,u,f,this.period,this.constant);this._xvals=i?i.slice(this.period-1):wjcChartFinance._range(this.period-1,t-1)}},t}(SingleOverlayIndicatorBase);exports.CCI=CCI;exports._cci=_cci;WilliamsR=function(n){function t(){n.call(this);this.period=14}return __extends(t,n),t.prototype._calculate=function(){var t=n.prototype._getLength.call(this);if(!(t<=0)){var r=n.prototype._getBindingValues.call(this,0),u=n.prototype._getBindingValues.call(this,1),f=n.prototype._getBindingValues.call(this,3),i=this._getXValues();this._yvals=_williamsR(r,u,f,this.period);this._xvals=i?i.slice(this.period-1):wjcChartFinance._range(this.period-1,t-1)}},t}(SingleOverlayIndicatorBase);exports.WilliamsR=WilliamsR;exports._williamsR=_williamsR,function(n){n[n.Simple=0]="Simple";n[n.Exponential=1]="Exponential"}(exports.MovingAverageType||(exports.MovingAverageType={}));MovingAverageType=exports.MovingAverageType;Envelopes=function(n){function t(){n.call(this);this._period=20;this._type=MovingAverageType.Simple;this._size=.025;this.rendering.addHandler(this._rendering,this)}return __extends(t,n),Object.defineProperty(t.prototype,"period",{get:function(){return this._period},set:function(n){n!==this._period&&(this._period=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(n){n!==this._type&&(this._type=wjcCore.asEnum(n,MovingAverageType,!1),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(n){n!==this._size&&(this._size=wjcCore.asNumber(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype.getDataRect=function(t,i){var r;if(i)return i;if(r=null,n.prototype._getLength.call(this)<=0)return r;this._shouldCalculate()&&(this._init(),this._calculate());var e=this._upperYVals.concat(this._lowerYVals),u=wjcChartFinance._minimum(this._xVals),o=wjcChartFinance._maximum(this._xVals),f=wjcChartFinance._minimum(e),s=wjcChartFinance._maximum(e);return wjcChart._DataInfo.isValid(u)&&wjcChart._DataInfo.isValid(o)&&wjcChart._DataInfo.isValid(f)&&wjcChart._DataInfo.isValid(s)&&(r=new wjcCore.Rect(u,f,o-u,s-f)),r},t.prototype._clearValues=function(){n.prototype._clearValues.call(this);this._upperYVals=null;this._lowerYVals=null;this._xVals=null},t.prototype._init=function(){n.prototype._init.call(this);this._upperYVals=[];this._lowerYVals=[];this._xVals=[]},t.prototype._shouldCalculate=function(){return!this._upperYVals||!this._lowerYVals||!this._xVals},t.prototype._calculate=function(){var u=this,i,r,t;if(!(n.prototype._getLength.call(this)<=0)){i=n.prototype.getValues.call(this,0);r=this._getXValues();switch(this.type){case MovingAverageType.Exponential:t=wjcChartFinance._ema(i,this.period);break;case MovingAverageType.Simple:default:t=wjcChartFinance._sma(i,this.period)}this._xVals=r?r.slice(this.period-1):wjcChartFinance._range(this.period-1,n.prototype._getLength.call(this)-1);this._upperYVals=t.map(function(n){return n+n*u.size});this._lowerYVals=t.map(function(n){return n-n*u.size})}},t.prototype._rendering=function(t,i){var r;if(i.cancel=!0,!(n.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var u=this.chart.series.indexOf(this),e=i.engine,v=this._getAxisX(),s=this._getAxisY(),h=wjcChartFinance._minimum(this._upperYVals.length,this._lowerYVals.length,this._xVals.length),p=wjcChart._BasePlotter.cloneStyle(this.style,["fill"]),b=this._getSymbolStroke(u),w=this.chart._plotrectId;if(h&&!(h<=0)){e.stroke=b;e.strokeWidth=2;var f=[],c=[],l=[],k=this._getLength(),a,o,y;for(r=0;r<h;r++)y=k-h+r,f.push(v.convert(this._xVals[r])),c.push(s.convert(this._upperYVals[r])),a=this._getDataPoint(this._xVals[r],this._upperYVals[r],u,y,v,s),o=new wjcChart._CircleArea(new wjcCore.Point(f[r],c[r]),.5*e.strokeWidth),o.tag=a,this._hitTester.add(o,u),l.push(s.convert(this._lowerYVals[r])),a=this._getDataPoint(this._xVals[r],this._lowerYVals[r],u,y,v,s),o=new wjcChart._CircleArea(new wjcCore.Point(f[r],l[r]),.5*e.strokeWidth),o.tag=a,this._hitTester.add(o,u);this._hitTester.add(new wjcChart._LinesArea(f,c),u);this._hitTester.add(new wjcChart._LinesArea(f,l),u);e.drawLines(f,c,null,p,w);e.drawLines(f,l,null,p,w)}}},t.prototype.getCalculatedValues=function(t){t=wjcCore.asString(t,!1);var r=[],i=0;if(n.prototype._getLength.call(this)<=0)return r;this._shouldCalculate()&&(this._init(),this._calculate());switch(t){case"upperEnvelope":for(;i<this._upperYVals.length;i++)r.push({x:this._xVals[i],y:this._upperYVals[i]});break;case"lowerEnvelope":for(;i<this._lowerYVals.length;i++)r.push({x:this._xVals[i],y:this._lowerYVals[i]})}return r},t}(OverlayIndicatorBase);exports.Envelopes=Envelopes;BollingerBands=function(n){function t(){n.call(this);this._period=20;this._multiplier=2;this.rendering.addHandler(this._rendering,this)}return __extends(t,n),Object.defineProperty(t.prototype,"period",{get:function(){return this._period},set:function(n){n!==this._period&&(this._period=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiplier",{get:function(){return this._multiplier},set:function(n){n!==this._multiplier&&(this._multiplier=wjcCore.asNumber(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype.getDataRect=function(t,i){if(i)return i;if(n.prototype._getLength.call(this)<=0)return null;this._shouldCalculate()&&(this._init(),this._calculate());var f=this._upperYVals.concat(this._lowerYVals),r=wjcChartFinance._minimum(this._xVals),e=wjcChartFinance._maximum(this._xVals),u=wjcChartFinance._minimum(f),o=wjcChartFinance._maximum(f);return wjcChart._DataInfo.isValid(r)&&wjcChart._DataInfo.isValid(e)&&wjcChart._DataInfo.isValid(u)&&wjcChart._DataInfo.isValid(o)?new wjcCore.Rect(r,u,e-r,o-u):null},t.prototype._clearValues=function(){n.prototype._clearValues.call(this);this._upperYVals=null;this._middleYVals=null;this._lowerYVals=null;this._xVals=null},t.prototype._shouldCalculate=function(){return!this._upperYVals||!this._middleYVals||!this._lowerYVals||!this._xVals},t.prototype._init=function(){n.prototype._init.call(this);this._upperYVals=[];this._middleYVals=[];this._lowerYVals=[];this._xVals=[]},t.prototype._calculate=function(){var i=n.prototype._getLength.call(this);if(!(i<=0)){var u=n.prototype.getValues.call(this,0),r=this._getXValues(),t=_bollingerBands(u,this.period,this.multiplier);this._upperYVals=t.uppers;this._middleYVals=t.middles;this._lowerYVals=t.lowers;this._xVals=r?r.slice(this.period-1):wjcChartFinance._range(this.period-1,i-1)}},t.prototype._rendering=function(t,i){var r;if(i.cancel=!0,!(n.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var u=this.chart.series.indexOf(this),o=i.engine,c=this._getAxisX(),s=this._getAxisY(),l=wjcChartFinance._minimum(this._upperYVals.length,this._middleYVals.length,this._lowerYVals.length,this._xVals.length),w=wjcChart._BasePlotter.cloneStyle(this.style,["fill"]),k=this._getSymbolStroke(u),b=this.chart._plotrectId;if(l&&!(l<=0)){o.stroke=k;o.strokeWidth=2;var f=[],a=[],v=[],y=[],d=this._getLength(),h,e,p;for(r=0;r<l;r++)p=d-l+r,f.push(c.convert(this._xVals[r])),a.push(s.convert(this._upperYVals[r])),h=this._getDataPoint(this._xVals[r],this._upperYVals[r],u,p,c,s),e=new wjcChart._CircleArea(new wjcCore.Point(f[r],a[r]),.5*o.strokeWidth),e.tag=h,this._hitTester.add(e,u),v.push(s.convert(this._middleYVals[r])),h=this._getDataPoint(this._xVals[r],this._middleYVals[r],u,p,c,s),e=new wjcChart._CircleArea(new wjcCore.Point(f[r],v[r]),.5*o.strokeWidth),e.tag=h,this._hitTester.add(e,u),y.push(s.convert(this._lowerYVals[r])),h=this._getDataPoint(this._xVals[r],this._lowerYVals[r],u,p,c,s),e=new wjcChart._CircleArea(new wjcCore.Point(f[r],y[r]),.5*o.strokeWidth),e.tag=h,this._hitTester.add(e,u);this._hitTester.add(new wjcChart._LinesArea(f,a),u);this._hitTester.add(new wjcChart._LinesArea(f,v),u);this._hitTester.add(new wjcChart._LinesArea(f,y),u);o.drawLines(f,a,null,w,b);o.drawLines(f,v,null,w,b);o.drawLines(f,y,null,w,b)}}},t.prototype.getCalculatedValues=function(t){t=wjcCore.asString(t,!1);var r=[],i=0;if(n.prototype._getLength.call(this)<=0)return r;this._shouldCalculate()&&(this._init(),this._calculate());switch(t){case"upperBand":for(;i<this._upperYVals.length;i++)r.push({x:this._xVals[i],y:this._upperYVals[i]});break;case"middleBand":for(;i<this._middleYVals.length;i++)r.push({x:this._xVals[i],y:this._middleYVals[i]});break;case"lowerBand":for(;i<this._lowerYVals.length;i++)r.push({x:this._xVals[i],y:this._lowerYVals[i]})}return r},t}(OverlayIndicatorBase);exports.BollingerBands=BollingerBands;exports._bollingerBands=_bollingerBands;RSI=function(n){function t(){n.call(this);this.period=14}return __extends(t,n),t.prototype._calculate=function(){var i=n.prototype._getLength.call(this),r,t;i<=0||(r=n.prototype._getBindingValues.call(this,0),t=this._getXValues(),this._yvals=_rsi(r,this.period),this._xvals=t?t.slice(this.period):wjcChartFinance._range(this.period,i))},t}(SingleOverlayIndicatorBase);exports.RSI=RSI;exports._rsi=_rsi;MacdBase=function(n){function t(){n.call(this);this._fastPeriod=12;this._slowPeriod=26;this._smoothingPeriod=9}return __extends(t,n),Object.defineProperty(t.prototype,"fastPeriod",{get:function(){return this._fastPeriod},set:function(n){n!==this._fastPeriod&&(this._fastPeriod=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slowPeriod",{get:function(){return this._slowPeriod},set:function(n){n!==this._slowPeriod&&(this._slowPeriod=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"smoothingPeriod",{get:function(){return this._smoothingPeriod},set:function(n){n!==this._smoothingPeriod&&(this._smoothingPeriod=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype._clearValues=function(){n.prototype._clearValues.call(this);this._macdVals=null;this._macdXVals=null;this._signalVals=null;this._signalXVals=null;this._histogramVals=null;this._histogramXVals=null},t.prototype._shouldCalculate=function(){return!this._macdVals||!this._macdXVals||!this._signalVals||!this._signalXVals||!this._histogramVals||!this._histogramXVals},t.prototype._init=function(){n.prototype._init.call(this);this._macdVals=[];this._macdXVals=[];this._signalVals=[];this._signalXVals=[];this._histogramVals=[];this._histogramXVals=[]},t.prototype._calculate=function(){var t=n.prototype._getLength.call(this);if(!(t<=0)){var u=n.prototype.getValues.call(this,0),i=this._getXValues(),r=_macd(u,this.fastPeriod,this.slowPeriod,this.smoothingPeriod);this._macdVals=r.macds;this._signalVals=r.signals;this._histogramVals=r.histograms;this._macdXVals=i?i.slice(t-this._macdVals.length,t):wjcChartFinance._range(t-this._macdVals.length,t-1);this._signalXVals=i?i.slice(t-this._signalVals.length,t):wjcChartFinance._range(t-this._signalVals.length,t-1);this._histogramXVals=i?i.slice(t-this._histogramVals.length,t):wjcChartFinance._range(t-this._histogramVals.length,t-1)}},t}(OverlayIndicatorBase);exports.MacdBase=MacdBase;Macd=function(n){function t(){n.call(this);this._seriesCount=2;this.rendering.addHandler(this._rendering,this)}return __extends(t,n),Object.defineProperty(t.prototype,"styles",{get:function(){return this._styles},set:function(n){n!==this._styles&&(this._styles=n,this._invalidate())},enumerable:!0,configurable:!0}),t.prototype.getDataRect=function(t,i){var f,r,u;if(i)return i;if(f=null,n.prototype._getLength.call(this)<=0)return f;this._shouldCalculate()&&(this._init(),this._calculate());r=[];u=[];u.push.apply(u,this._macdXVals);u.push.apply(u,this._signalXVals);r.push.apply(r,this._macdVals);r.push.apply(r,this._signalVals);var e=wjcChartFinance._minimum(u),s=wjcChartFinance._maximum(u),o=wjcChartFinance._minimum(r),h=wjcChartFinance._maximum(r);return wjcChart._DataInfo.isValid(e)&&wjcChart._DataInfo.isValid(s)&&wjcChart._DataInfo.isValid(o)&&wjcChart._DataInfo.isValid(h)&&(f=new wjcCore.Rect(e,o,s-e,h-o)),f},t.prototype._rendering=function(t,i){if(i.cancel=!0,!(n.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var f=this.chart.series.indexOf(this),u=i.engine,c=this._getAxisX(),l=this._getAxisY(),d=wjcChart._BasePlotter.cloneStyle(this.style,["fill"]),a=this._getSymbolStroke(f),g=this.chart._plotrectId,v=2,s=null,nt=a,tt=v,h=null,it=a,rt=v;this.styles&&wjcCore.isObject(this.styles)&&(this.styles.macdLine&&wjcCore.isObject(this.styles.macdLine)&&(s=wjcChart._BasePlotter.cloneStyle(this.styles.macdLine,["fill"]),nt=s.stroke?s.stroke:a,tt=s.strokeWidth?s.strokeWidth:v),this.styles.signalLine&&wjcCore.isObject(this.styles.signalLine)&&(h=wjcChart._BasePlotter.cloneStyle(this.styles.signalLine,["fill"]),it=h.stroke?h.stroke:a,rt=h.strokeWidth?h.strokeWidth:v));for(var y=[],p=[],w=[],b=[],e,o,ut=this._getLength(),k,r=0;r<this._macdVals.length;r++)k=ut-this._macdVals.length+r,p.push(c.convert(this._macdXVals[r])),y.push(l.convert(this._macdVals[r])),e=this._getDataPoint(this._macdXVals[r],this._macdVals[r],f,k,c,l),e.name=this._getName(0),o=new wjcChart._CircleArea(new wjcCore.Point(p[r],y[r]),.5*u.strokeWidth),o.tag=e,this._hitTester.add(o,f);for(this._hitTester.add(new wjcChart._LinesArea(p,y),f),u.stroke=nt,u.strokeWidth=tt,u.drawLines(p,y,null,d,g),r=0;r<this._signalVals.length;r++)k=ut-this._signalVals.length+r,b.push(c.convert(this._signalXVals[r])),w.push(l.convert(this._signalVals[r])),e=this._getDataPoint(this._signalXVals[r],this._signalVals[r],f,k,c,l),e.name=this._getName(1),o=new wjcChart._CircleArea(new wjcCore.Point(b[r],w[r]),.5*u.strokeWidth),o.tag=e,this._hitTester.add(o,f);this._hitTester.add(new wjcChart._LinesArea(b,w),f);u.stroke=it;u.strokeWidth=rt;u.drawLines(b,w,null,d,g)}},t.prototype.getCalculatedValues=function(t){t=wjcCore.asString(t,!1);var r=[],i=0;if(n.prototype._getLength.call(this)<=0)return r;this._shouldCalculate()&&(this._init(),this._calculate());switch(t){case"macdLine":for(;i<this._macdVals.length;i++)r.push({x:this._macdXVals[i],y:this._macdVals[i]});break;case"signalLine":for(;i<this._signalVals.length;i++)r.push({x:this._signalXVals[i],y:this._signalVals[i]})}return r},t}(MacdBase);exports.Macd=Macd;MacdHistogram=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.getValues=function(t){var i=null;return n.prototype._getLength.call(this)<=0?i:(this._shouldCalculate()&&(this._init(),this._calculate()),t===0?i=this._histogramVals:t===1&&(i=this._histogramXVals),i)},t.prototype.getDataRect=function(t,i){var r;if(i)return i;if(r=null,n.prototype._getLength.call(this)<=0)return r;this._shouldCalculate()&&(this._init(),this._calculate());var u=wjcChartFinance._minimum(this._histogramXVals),e=wjcChartFinance._maximum(this._histogramXVals),f=wjcChartFinance._minimum(this._histogramVals),o=wjcChartFinance._maximum(this._histogramVals);return wjcChart._DataInfo.isValid(u)&&wjcChart._DataInfo.isValid(e)&&wjcChart._DataInfo.isValid(f)&&wjcChart._DataInfo.isValid(o)&&(r=new wjcCore.Rect(u,f,e-u,o-f)),r},t.prototype._getChartType=function(){return wjcChart.ChartType.Column},t.prototype._getItem=function(t){var i=n.prototype._getLength.call(this),r=wjcChartFinance._minimum(this._histogramVals.length,this._histogramXVals.length);return t=i-r+t,n.prototype._getItem.call(this,t)},t}(MacdBase);exports.MacdHistogram=MacdHistogram;exports._macd=_macd;Stochastic=function(n){function t(){n.call(this);this._kPeriod=14;this._dPeriod=3;this._smoothingPeriod=1;this._seriesCount=2;this.rendering.addHandler(this._rendering,this)}return __extends(t,n),Object.defineProperty(t.prototype,"kPeriod",{get:function(){return this._kPeriod},set:function(n){n!==this._kPeriod&&(this._kPeriod=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dPeriod",{get:function(){return this._dPeriod},set:function(n){n!==this._dPeriod&&(this._dPeriod=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"smoothingPeriod",{get:function(){return this._smoothingPeriod},set:function(n){n!==this._smoothingPeriod&&(this._smoothingPeriod=wjcCore.asInt(n,!1,!0),this._clearValues(),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return this._styles},set:function(n){n!==this._styles&&(this._styles=n,this._invalidate())},enumerable:!0,configurable:!0}),t.prototype.getDataRect=function(t,i){var r;if(i)return i;if(r=null,n.prototype._getLength.call(this)<=0)return r;this._shouldCalculate()&&(this._init(),this._calculate());var e=this._kVals.concat(this._dVals),o=this._kXVals.concat(this._dXVals),u=wjcChartFinance._minimum(o),s=wjcChartFinance._maximum(o),f=wjcChartFinance._minimum(e),h=wjcChartFinance._maximum(e);return wjcChart._DataInfo.isValid(u)&&wjcChart._DataInfo.isValid(s)&&wjcChart._DataInfo.isValid(f)&&wjcChart._DataInfo.isValid(h)&&(r=new wjcCore.Rect(u,f,s-u,h-f)),r},t.prototype._clearValues=function(){n.prototype._clearValues.call(this);this._kVals=null;this._kXVals=null;this._dVals=null;this._dXVals=null},t.prototype._shouldCalculate=function(){return!this._kVals||!this._kXVals||!this._dVals||!this._dXVals},t.prototype._init=function(){n.prototype._init.call(this);this._kVals=[];this._kXVals=[];this._dVals=[];this._dXVals=[]},t.prototype._calculate=function(){var r=n.prototype._getLength.call(this);if(!(n.prototype._getLength.call(this)<=0)){var u=n.prototype._getBindingValues.call(this,0),f=n.prototype._getBindingValues.call(this,1),e=n.prototype._getBindingValues.call(this,3),t=this._getXValues(),i=_stochastic(u,f,e,this.kPeriod,this.dPeriod,this.smoothingPeriod);this._kVals=i.ks;this._dVals=i.ds;this._kXVals=t?t.slice(this.kPeriod-1):wjcChartFinance._range(this.kPeriod-1,r-1);this.smoothingPeriod&&this.smoothingPeriod>1&&(this._kXVals=this._kXVals.slice(this._kXVals.length-this._kVals.length,this._kXVals.length));this._dXVals=this._kXVals.slice(this._kXVals.length-this._dVals.length,this._kXVals.length)}},t.prototype._rendering=function(t,i){if(i.cancel=!0,!(n.prototype._getLength.call(this)<=0)){this._shouldCalculate()&&(this._init(),this._calculate());var f=this.chart.series.indexOf(this),u=i.engine,c=this._getAxisX(),l=this._getAxisY(),d=wjcChart._BasePlotter.cloneStyle(this.style,["fill"]),a=this._getSymbolStroke(f),g=this.chart._plotrectId,v=2,s=null,nt=a,tt=v,h=null,it=a,rt=v;this.styles&&wjcCore.isObject(this.styles)&&(this.styles.kLine&&wjcCore.isObject(this.styles.kLine)&&(s=wjcChart._BasePlotter.cloneStyle(this.styles.kLine,["fill"]),nt=s.stroke?s.stroke:a,tt=s.strokeWidth?s.strokeWidth:v),this.styles.dLine&&wjcCore.isObject(this.styles.dLine)&&(h=wjcChart._BasePlotter.cloneStyle(this.styles.dLine,["fill"]),it=h.stroke?h.stroke:a,rt=h.strokeWidth?h.strokeWidth:v));for(var y=[],p=[],w=[],b=[],ut=this._getLength(),e,o,k,r=0;r<this._kVals.length;r++)k=ut-this._kVals.length+r,p.push(c.convert(this._kXVals[r])),y.push(l.convert(this._kVals[r])),e=this._getDataPoint(this._kXVals[r],this._kVals[r],f,k,c,l),e.name=this._getName(0),o=new wjcChart._CircleArea(new wjcCore.Point(p[r],y[r]),.5*u.strokeWidth),o.tag=e,this._hitTester.add(o,f);for(this._hitTester.add(new wjcChart._LinesArea(p,y),f),u.stroke=nt,u.strokeWidth=tt,u.drawLines(p,y,null,d,g),r=0;r<this._dVals.length;r++)k=ut-this._dVals.length+r,b.push(c.convert(this._dXVals[r])),w.push(l.convert(this._dVals[r])),e=this._getDataPoint(this._dXVals[r],this._dVals[r],f,k,c,l),e.name=this._getName(1),o=new wjcChart._CircleArea(new wjcCore.Point(b[r],w[r]),.5*u.strokeWidth),o.tag=e,this._hitTester.add(o,f);this._hitTester.add(new wjcChart._LinesArea(b,w),f);u.stroke=it;u.strokeWidth=rt;u.drawLines(b,w,null,d,g)}},t.prototype.getCalculatedValues=function(t){t=wjcCore.asString(t,!1);var r=[],i=0;if(n.prototype._getLength.call(this)<=0)return r;this._shouldCalculate()&&(this._init(),this._calculate());switch(t){case"kLine":for(;i<this._kVals.length;i++)r.push({x:this._kXVals[i],y:this._kVals[i]});break;case"dLine":for(;i<this._dVals.length;i++)r.push({x:this._dXVals[i],y:this._dVals[i]})}return r},t}(OverlayIndicatorBase);exports.Stochastic=Stochastic;exports._stochastic=_stochastic