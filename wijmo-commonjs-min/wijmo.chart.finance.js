/*
    *
    * Wijmo Library 5.20171.282
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
"use strict";function _trunc(n){return wjcCore.asNumber(n,!0,!1),n>0?Math.floor(n):Math.ceil(n)}function _sum(n){return arguments.length>1&&(n=Array.prototype.slice.call(arguments)),wjcCore.asArray(n,!1),n.reduce(function(n,t){return n+wjcCore.asNumber(t)},0)}function _average(n){return arguments.length>1&&(n=Array.prototype.slice.call(arguments)),wjcCore.asArray(n,!1),_sum(n)/n.length}function _minimum(n){return arguments.length>1&&(n=Array.prototype.slice.call(arguments)),wjcCore.asArray(n,!1),Math.min.apply(null,n)}function _maximum(n){return arguments.length>1&&(n=Array.prototype.slice.call(arguments)),wjcCore.asArray(n,!1),Math.max.apply(null,n)}function _variance(n){arguments.length>1&&(n=Array.prototype.slice.call(arguments));wjcCore.asArray(n,!1);var t=_average(n),i=n.map(function(n){return Math.pow(n-t,2)});return _average(i)}function _stdDeviation(n){return arguments.length>1&&(n=Array.prototype.slice.call(arguments)),wjcCore.asArray(n,!1),Math.sqrt(_variance(n))}function _avgTrueRng(n,t,i,r){var u;r===void 0&&(r=14);wjcCore.asArray(n,!1);wjcCore.asArray(t,!1);wjcCore.asArray(i,!1);wjcCore.asInt(r,!1,!0);var e=_trueRng(n,t,i,r),o=Math.min(n.length,t.length,i.length,e.length),f=[];for(wjcCore.assert(o>r&&r>1,"Average True Range period must be an integer less than the length of the data and greater than one."),u=0;u<o;u++)wjcCore.asNumber(n[u],!1),wjcCore.asNumber(t[u],!1),wjcCore.asNumber(i[u],!1),wjcCore.asNumber(e[u],!1),u+1===r?f.push(_average(e.slice(0,r))):u+1>r&&f.push(((r-1)*f[f.length-1]+e[u])/r);return f}function _trueRng(n,t,i,r){var e,f,u;for(r===void 0&&(r=14),wjcCore.asArray(n,!1),wjcCore.asArray(t,!1),wjcCore.asArray(i,!1),wjcCore.asInt(r,!1,!0),e=Math.min(n.length,t.length,i.length),f=[],wjcCore.assert(e>r&&r>1,"True Range period must be an integer less than the length of the data and greater than one."),u=0;u<e;u++)wjcCore.asNumber(n[u],!1),wjcCore.asNumber(t[u],!1),wjcCore.asNumber(i[u],!1),u===0?f.push(n[u]-t[u]):f.push(Math.max(n[u]-t[u],Math.abs(n[u]-i[u-1]),Math.abs(t[u]-i[u-1])));return f}function _sma(n,t){var r,i;for(wjcCore.asArray(n,!1),wjcCore.asNumber(t,!1,!0),wjcCore.assert(n.length>t&&t>1,"Simple Moving Average period must be an integer less than the length of the data and greater than one."),r=[],i=t;i<=n.length;i++)r.push(_average(n.slice(i-t,i)));return r}function _ema(n,t){var i;wjcCore.asArray(n,!1);wjcCore.asNumber(t,!1,!0);wjcCore.assert(n.length>t&&t>1,"Exponential Moving Average period must be an integer less than the length of the data and greater than one.");var r=[],u=2/(t+1),f=_sma(n,t);for(n=n.slice(t-1),i=0;i<n.length;i++)i===0?r.push(f[0]):r.push((n[i]-r[i-1])*u+r[i-1]);return r}function _range(n,t,i){var u,r;for(i===void 0&&(i=1),wjcCore.asNumber(n,!1),wjcCore.asNumber(t,!1),wjcCore.asNumber(i,!1),wjcCore.assert(n<t,"begin argument must be less than end argument."),u=[],r=n;r<=t;r+=i)u.push(r);return u}var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},wjcCore=require('wijmo/wijmo'),wjcChart=require('wijmo/wijmo.chart'),wjcSelf=require('wijmo/wijmo.chart.finance'),FinancialChartType,FinancialChart,FinancialSeries,_BaseCalculator,_HeikinAshiCalculator,_BaseRangeCalculator,_LineBreakCalculator,_KagiCalculator,_RenkoCalculator,_HeikinAshiPlotter,_BaseRangePlotter,DataFields,RangeMode,_LineBreakPlotter,_RenkoPlotter,_KagiPlotter;window.wijmo=window.wijmo||{};window.wijmo.chart=window.wijmo.chart||{};window.wijmo.chart.finance=wjcSelf;exports._trunc=_trunc;exports._sum=_sum;exports._average=_average;exports._minimum=_minimum;exports._maximum=_maximum;exports._variance=_variance;exports._stdDeviation=_stdDeviation;exports._avgTrueRng=_avgTrueRng;exports._trueRng=_trueRng;exports._sma=_sma;exports._ema=_ema;exports._range=_range,function(n){n[n.Column=0]="Column";n[n.Scatter=1]="Scatter";n[n.Line=2]="Line";n[n.LineSymbols=3]="LineSymbols";n[n.Area=4]="Area";n[n.Candlestick=5]="Candlestick";n[n.HighLowOpenClose=6]="HighLowOpenClose";n[n.HeikinAshi=7]="HeikinAshi";n[n.LineBreak=8]="LineBreak";n[n.Renko=9]="Renko";n[n.Kagi=10]="Kagi";n[n.ColumnVolume=11]="ColumnVolume";n[n.EquiVolume=12]="EquiVolume";n[n.CandleVolume=13]="CandleVolume";n[n.ArmsCandleVolume=14]="ArmsCandleVolume"}(exports.FinancialChartType||(exports.FinancialChartType={}));FinancialChartType=exports.FinancialChartType;FinancialChart=function(n){function t(t,i){n.call(this,t,i);this._chartType=FinancialChartType.Line;this.__heikinAshiPlotter=null;this.__lineBreakPlotter=null;this.__renkoPlotter=null;this.__kagiPlotter=null}return __extends(t,n),Object.defineProperty(t.prototype,"chartType",{get:function(){return this._chartType},set:function(n){n!=this._chartType&&(this._chartType=wjcCore.asEnum(n,FinancialChartType),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},set:function(n){n!=this._options&&(this._options=n,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_heikinAshiPlotter",{get:function(){return this.__heikinAshiPlotter===null&&(this.__heikinAshiPlotter=new _HeikinAshiPlotter,this._initPlotter(this.__heikinAshiPlotter)),this.__heikinAshiPlotter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_lineBreakPlotter",{get:function(){return this.__lineBreakPlotter===null&&(this.__lineBreakPlotter=new _LineBreakPlotter,this._initPlotter(this.__lineBreakPlotter)),this.__lineBreakPlotter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_renkoPlotter",{get:function(){return this.__renkoPlotter===null&&(this.__renkoPlotter=new _RenkoPlotter,this._initPlotter(this.__renkoPlotter)),this.__renkoPlotter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_kagiPlotter",{get:function(){return this.__kagiPlotter===null&&(this.__kagiPlotter=new _KagiPlotter,this._initPlotter(this.__kagiPlotter)),this.__kagiPlotter},enumerable:!0,configurable:!0}),t.prototype._getChartType=function(){var n=null;switch(this.chartType){case FinancialChartType.Area:n=wjcChart.ChartType.Area;break;case FinancialChartType.Line:case FinancialChartType.Kagi:n=wjcChart.ChartType.Line;break;case FinancialChartType.Column:case FinancialChartType.ColumnVolume:n=wjcChart.ChartType.Column;break;case FinancialChartType.LineSymbols:n=wjcChart.ChartType.LineSymbols;break;case FinancialChartType.Scatter:n=wjcChart.ChartType.Scatter;break;case FinancialChartType.Candlestick:case FinancialChartType.Renko:case FinancialChartType.HeikinAshi:case FinancialChartType.LineBreak:case FinancialChartType.EquiVolume:case FinancialChartType.CandleVolume:case FinancialChartType.ArmsCandleVolume:n=wjcChart.ChartType.Candlestick;break;case FinancialChartType.HighLowOpenClose:n=wjcChart.ChartType.HighLowOpenClose}return n},t.prototype._getPlotter=function(t){var u=this.chartType,i=null,f=!1,r;t&&(r=t.chartType,r&&!wjcCore.isUndefined(r)&&r!=u&&(u=r,f=!0));switch(u){case FinancialChartType.HeikinAshi:i=this._heikinAshiPlotter;break;case FinancialChartType.LineBreak:i=this._lineBreakPlotter;break;case FinancialChartType.Renko:i=this._renkoPlotter;break;case FinancialChartType.Kagi:i=this._kagiPlotter;break;case FinancialChartType.ColumnVolume:i=n.prototype._getPlotter.call(this,t);i.isVolume=!0;i.width=1;break;case FinancialChartType.EquiVolume:i=n.prototype._getPlotter.call(this,t);i.isEqui=!0;i.isCandle=!1;i.isArms=!1;i.isVolume=!0;i.symbolWidth="100%";break;case FinancialChartType.CandleVolume:i=n.prototype._getPlotter.call(this,t);i.isEqui=!1;i.isCandle=!0;i.isArms=!1;i.isVolume=!0;i.symbolWidth="100%";break;case FinancialChartType.ArmsCandleVolume:i=n.prototype._getPlotter.call(this,t);i.isEqui=!1;i.isCandle=!1;i.isArms=!0;i.isVolume=!0;i.symbolWidth="100%";break;default:i=n.prototype._getPlotter.call(this,t)}return i},t.prototype._createSeries=function(){return new FinancialSeries},t}(wjcChart.FlexChartCore);exports.FinancialChart=FinancialChart;FinancialSeries=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),Object.defineProperty(t.prototype,"chartType",{get:function(){return this._finChartType},set:function(n){n!=this._finChartType&&(this._finChartType=wjcCore.asEnum(n,FinancialChartType,!0),this._invalidate())},enumerable:!0,configurable:!0}),t.prototype._getChartType=function(){var n=null;switch(this.chartType){case FinancialChartType.Area:n=wjcChart.ChartType.Area;break;case FinancialChartType.Line:case FinancialChartType.Kagi:n=wjcChart.ChartType.Line;break;case FinancialChartType.Column:case FinancialChartType.ColumnVolume:n=wjcChart.ChartType.Column;break;case FinancialChartType.LineSymbols:n=wjcChart.ChartType.LineSymbols;break;case FinancialChartType.Scatter:n=wjcChart.ChartType.Scatter;break;case FinancialChartType.Candlestick:case FinancialChartType.Renko:case FinancialChartType.HeikinAshi:case FinancialChartType.LineBreak:case FinancialChartType.EquiVolume:case FinancialChartType.CandleVolume:case FinancialChartType.ArmsCandleVolume:n=wjcChart.ChartType.Candlestick;break;case FinancialChartType.HighLowOpenClose:n=wjcChart.ChartType.HighLowOpenClose}return n},t}(wjcChart.SeriesBase);exports.FinancialSeries=FinancialSeries;_BaseCalculator=function(){function n(n,t,i,r){this.highs=n;this.lows=t;this.opens=i;this.closes=r}return n.prototype.calculate=function(){},n}();exports._BaseCalculator=_BaseCalculator;_HeikinAshiCalculator=function(n){function t(t,i,r,u){n.call(this,t,i,r,u)}return __extends(t,n),t.prototype.calculate=function(){var e=Math.min(this.highs.length,this.lows.length,this.opens.length,this.closes.length),u,f,t,r,i=[],n;if(e<=0)return i;for(n=0;n<e;n++)r=_average(this.highs[n],this.lows[n],this.opens[n],this.closes[n]),n===0?(t=_average(this.opens[n],this.closes[n]),u=this.highs[n],f=this.lows[n]):(t=_average(i[n-1].open,i[n-1].close),u=Math.max(this.highs[n],t,r),f=Math.min(this.lows[n],t,r)),i.push({high:u,low:f,close:r,open:t,pointIndex:n,x:null});return i},t}(_BaseCalculator);exports._HeikinAshiCalculator=_HeikinAshiCalculator;_BaseRangeCalculator=function(n){function t(t,i,r,u,f,e,o,s){n.call(this,t,i,r,u);this.xs=f;this.size=e;this.unit=o;this.fields=s}return __extends(t,n),t.prototype._getValues=function(){var t=[],i=Math.min(this.highs.length,this.lows.length,this.opens.length,this.closes.length),n;switch(this.fields){case DataFields.High:t=this.highs;break;case DataFields.Low:t=this.lows;break;case DataFields.Open:t=this.opens;break;case DataFields.HL2:for(n=0;n<i;n++)t.push(_average(this.highs[n],this.lows[n]));break;case DataFields.HLC3:for(n=0;n<i;n++)t.push(_average(this.highs[n],this.lows[n],this.closes[n]));break;case DataFields.HLOC4:for(n=0;n<i;n++)t.push(_average(this.highs[n],this.lows[n],this.opens[n],this.closes[n]));break;case DataFields.Close:default:t=this.closes}return t},t.prototype._getSize=function(){var n=this.unit===RangeMode.ATR?_avgTrueRng(this.highs,this.lows,this.closes,this.size):null;return this.unit===RangeMode.ATR?n[n.length-1]:this.size},t}(_BaseCalculator);exports._BaseRangeCalculator=_BaseRangeCalculator;_LineBreakCalculator=function(n){function t(t,i,r,u,f,e){n.call(this,t,i,r,u,f,e)}return __extends(t,n),t.prototype.calculate=function(){var a=this.xs!==null&&this.xs.length>0,o=this.closes.length,f=[],n=[[],[]],e,t,s,i,h,u,c,l,r;if(o<=0)return f;for(e=[],r=1;r<o;r++){if(h=f.length,u=h-1,s=a?this.xs[r]:r,i=this.closes[r],u===-1){if(t=this.closes[0],t===i)continue}else if(e=this._trendExists(n)||this.size===1?n[0].slice(-this.size).concat(n[1].slice(-this.size)):n[0].slice(1-this.size).concat(n[1].slice(1-this.size)),c=Math.max.apply(null,e),l=Math.min.apply(null,e),i>c)t=Math.max(n[0][u],n[1][u]);else if(i<l)t=Math.min(n[0][u],n[1][u]);else continue;n[0].push(t);n[1].push(i);f.push({high:Math.max(t,i),low:Math.min(t,i),open:t,close:i,x:s,pointIndex:r})}return f},t.prototype._trendExists=function(n){if(n[1].length<this.size)return!1;for(var i=!1,r=n[1].slice(-this.size),t=1;t<this.size;t++)if(i=r[t]>r[t-1],!i)break;if(!i)for(t=1;t<this.size;t++)if(i=r[t]<r[t-1],!i)break;return i},t}(_BaseRangeCalculator);exports._LineBreakCalculator=_LineBreakCalculator;_KagiCalculator=function(n){function t(t,i,r,u,f,e,o,s){n.call(this,t,i,r,u,f,e,o,s)}return __extends(t,n),t.prototype.calculate=function(){var o=this._getSize(),v=Math.min(this.highs.length,this.lows.length,this.opens.length,this.closes.length),y=this._getValues(),p=this.xs!==null&&this.xs.length>0,u=[],r=[[],[]],e,l,t,w,n,s,h,f,c,a,i;if(v<=0)return u;for(i=1;i<v;i++){if(w=u.length,n=w-1,l=p?this.xs[i]:i,a=i,c=!1,this.fields===DataFields.HighLow)if(n===-1)if(this.highs[i]>this.highs[0])t=this.highs[i];else if(this.lows[i]<this.lows[0])t=this.lows[i];else continue;else if(f=r[1][n]-r[0][n],f>0)if(this.highs[i]>r[1][n])t=this.highs[i];else if(this.lows[i]<r[1][n])t=this.lows[i];else continue;else if(this.lows[i]<r[1][n])t=this.lows[i];else if(this.highs[i]>r[1][n])t=this.highs[i];else continue;else t=y[i];if(this.unit===RangeMode.Percentage&&(o=t*this.size),n===-1){if(l=p?this.xs[0]:0,a=0,e=this.fields===DataFields.HighLow?this.highs[0]:y[0],f=Math.abs(e-t),f<o)continue}else if(f=r[1][n]-r[0][n],h=Math.max(r[0][n],r[1][n]),s=Math.min(r[0][n],r[1][n]),f>0)if(t>h)c=!0;else if(f=h-t,f>=o)e=h;else continue;else if(t<s)c=!0;else if(f=t-s,f>=o)e=s;else continue;c?(r[1][n]=t,u[n].close=t,u[n].high=Math.max(u[n].open,u[n].close),u[n].low=Math.min(u[n].open,u[n].close)):(r[0].push(e),r[1].push(t),u.push({high:Math.max(e,t),low:Math.min(e,t),open:e,close:t,x:l,pointIndex:a}))}return u},t}(_BaseRangeCalculator);exports._KagiCalculator=_KagiCalculator;_RenkoCalculator=function(n){function t(t,i,r,u,f,e,o,s,h){h===void 0&&(h=!1);n.call(this,t,i,r,u,f,e,o,s);this.rounding=h}return __extends(t,n),t.prototype.calculate=function(){var f=this._getSize(),a=Math.min(this.highs.length,this.lows.length,this.opens.length,this.closes.length),w=this.xs!==null&&this.xs.length>0,v=this._getValues(),c=[],u=[[],[]],n,y,e,p,r,o,s,h,t,l,i;if(a<=0)return c;for(t=1;t<a;t++){if(p=c.length,r=p-1,y=w?this.xs[t]:t,this.fields===DataFields.HighLow)if(r===-1)if(this.highs[t]-this.highs[0]>f)n=this.highs[0],e=this.highs[t];else if(this.lows[0]-this.lows[t]>f)n=this.lows[0],e=this.lows[t];else continue;else if(o=Math.min(u[0][r],u[1][r]),s=Math.max(u[0][r],u[1][r]),this.highs[t]-s>f)n=s,e=this.highs[t];else if(o-this.lows[t]>f)n=o,e=this.lows[t];else continue;else if(e=v[t],r===-1)n=v[0];else if(o=Math.min(u[0][r],u[1][r]),s=Math.max(u[0][r],u[1][r]),e>s)n=s;else if(e<o)n=o;else continue;if(h=e-n,!(Math.abs(h)<f))for(h=_trunc(h/f),l=0;l<Math.abs(h);l++)i={},this.rounding&&(n=this._round(n,f)),u[0].push(n),i.open=n,n=h>0?n+f:n-f,u[1].push(n),i.close=n,i.x=y,i.pointIndex=t,i.high=Math.max(i.open,i.close),i.low=Math.min(i.open,i.close),c.push(i)}return c},t.prototype._round=function(n,t){return Math.round(n/t)*t},t}(_BaseRangeCalculator);exports._RenkoCalculator=_RenkoCalculator;_HeikinAshiPlotter=function(n){function t(){n.call(this);this._symFactor=.7;this.clear()}return __extends(t,n),t.prototype.clear=function(){n.prototype.clear.call(this);this._haValues=null;this._calculator=null},t.prototype.plotSeries=function(n,t,i,r){var ut=this,w,u,p;this._calculate(r);var s=wjcCore.asType(r,wjcChart.SeriesBase),e=this.chart.series.indexOf(r),o=r.getValues(1),k=this._symFactor,l=this._haValues.length,d=!0;o?(w=this.dataInfo.getDeltaX(),w>0&&(k*=w)):o=this.dataInfo.getXVals();o?l=Math.min(l,o.length):(d=!1,o=new Array(l));var ft=this._DEFAULT_WIDTH,et=s._getSymbolFill(e),ot=s._getAltSymbolFill(e)||"transparent",g=s._getSymbolStroke(e),st=s._getAltSymbolStroke(e)||g,nt=k,tt=r.getDataType(1)||r.chart._xDataType;n.strokeWidth=ft;var ht=t.actualMin,ct=t.actualMax,it=0,a,rt,f,v,y,b,h,c;for(u=0;u<l;u++)f=d?o[u]:u,wjcChart._DataInfo.isValid(f)&&ht<=f&&f<=ct&&(y=this._haValues[u].high,b=this._haValues[u].low,h=this._haValues[u].open,c=this._haValues[u].close,a=h<c?ot:et,rt=h<c?st:g,n.fill=a,n.stroke=rt,n.startGroup(),v=this._getDataPoint(e,u,f,r),this.chart.itemFormatter?(p=new wjcChart.HitTestInfo(this.chart,new wjcCore.Point(t.convert(f),i.convert(y)),wjcChart.ChartElement.SeriesSymbol),p._setData(s,u),p._setDataPoint(v),this.chart.itemFormatter(n,p,function(){ut._drawSymbol(n,t,i,e,u,a,nt,f,y,b,h,c,v,tt)})):this._drawSymbol(n,t,i,e,u,a,nt,f,y,b,h,c,v,tt),n.endGroup(),r._setPointIndex(u,it),it++)},t.prototype._drawSymbol=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var k,y=null,b=null,p=null,w=null,d=v===wjcCore.DataType.Date?432e5:.5,g;p=t.convert(o-d*e);w=t.convert(o+d*e);p>w&&(g=p,p=w,w=g);o=t.convert(o);wjcChart._DataInfo.isValid(c)&&wjcChart._DataInfo.isValid(l)&&(c=i.convert(c),l=i.convert(l),y=Math.min(c,l),b=y+Math.abs(c-l),n.drawRect(p,y,w-p,b-y),k=new wjcChart._RectArea(new wjcCore.Rect(p,y,w-p,b-y)),k.tag=a,this.hitTester.add(k,r));wjcChart._DataInfo.isValid(s)&&(s=i.convert(s),y!==null&&n.drawLine(o,y,o,s));wjcChart._DataInfo.isValid(h)&&(h=i.convert(h),b!==null&&n.drawLine(o,b,o,h))},t.prototype._getDataPoint=function(n,t,i,r){var u=new wjcChart._DataPoint(n,t,i,this._haValues[t].high),f=r._getItem(t),e=r._getBinding(0),o=r._getBinding(1),s=r._getBinding(2),h=r._getBinding(3),c=r._getAxisY();return u.item=wjcChart._BasePlotter.cloneStyle(f,[]),u.item[e]=this._haValues[t].high,u.item[o]=this._haValues[t].low,u.item[s]=this._haValues[t].open,u.item[h]=this._haValues[t].close,u.y=this._haValues[t].high,u.yfmt=c._formatValue(this._haValues[t].high),u},t.prototype._calculate=function(n){var t=n._getBindingValues(0),i=n._getBindingValues(1),r=n._getBindingValues(2),u=n._getBindingValues(3);this._calculator=new _HeikinAshiCalculator(t,i,r,u);this._haValues=this._calculator.calculate();(this._haValues===null||wjcCore.isUndefined(this._haValues))&&this._init()},t.prototype._init=function(){this._haValues=[]},t}(wjcChart._FinancePlotter);exports._HeikinAshiPlotter=_HeikinAshiPlotter;_BaseRangePlotter=function(n){function t(){n.call(this);this._symFactor=.7;this.clear()}return __extends(t,n),t.prototype.clear=function(){n.prototype.clear.call(this);this._rangeValues=null;this._rangeXLabels=null;this._calculator=null},t.prototype.unload=function(){var r,t,i;for(n.prototype.unload.call(this),i=0;i<this.chart.series.length;i++)(r=this.chart.series[i],r)&&(t=r._getAxisX(),t&&t.itemsSource&&(t.itemsSource=null))},t.prototype.adjustLimits=function(){var r,n,u,t=0,e=0,f=0,o=0,s,h=this.chart._xDataType===wjcCore.DataType.Date?.5:0,i;for(wjcCore.assert(this.chart.series.length<=1,"Current FinancialChartType only supports a single series"),i=0;i<this.chart.series.length;i++)(r=this.chart.series[i],this._calculate(r),this._rangeValues.length<=0||this._rangeXLabels.length<=0)||(n=this._rangeValues.map(function(n){return n.open}),n.push.apply(n,this._rangeValues.map(function(n){return n.close})),u=this._rangeXLabels.map(function(n){return n.value}),f=Math.min.apply(null,n),o=Math.max.apply(null,n),t=Math.min.apply(null,u),e=Math.max.apply(null,u),s=r._getAxisX(),s.itemsSource=this._rangeXLabels);return t-=h,new wjcCore.Rect(t,f,e-t+h,o-f)},t.prototype.plotSeries=function(n,t,i,r){var y=this,h,e,s,o,c,u,l;this._calculate(r);var f=this.chart.series.indexOf(r),p=this._rangeValues.length,w=t.actualMin,b=t.actualMax,k=this._DEFAULT_WIDTH,a=this._symFactor,d=r._getSymbolFill(f),g=r._getAltSymbolFill(f)||"transparent",v=r._getSymbolStroke(f),nt=r._getAltSymbolStroke(f)||v;for(n.strokeWidth=k,h=0,u=0;u<p;u++)e=u,wjcChart._DataInfo.isValid(e)&&w<=e&&e<=b&&(s=this._rangeValues[u].open,o=this._rangeValues[u].close,n.fill=s>o?d:g,n.stroke=s>o?v:nt,c=this._getDataPoint(f,u,r,Math.max(s,o)),n.startGroup(),this.chart.itemFormatter?(l=new wjcChart.HitTestInfo(this.chart,new wjcCore.Point(t.convert(e),i.convert(o)),wjcChart.ChartElement.SeriesSymbol),l._setData(r,u),l._setDataPoint(c),this.chart.itemFormatter(n,l,function(){y._drawSymbol(n,t,i,f,h,a,e,s,o,c)})):this._drawSymbol(n,t,i,f,h,a,e,s,o,c),n.endGroup(),r._setPointIndex(u,h),h++)},t.prototype._drawSymbol=function(n,t,i,r,u,f,e,o,s,h){var l,v,c,a,y,p;c=t.convert(e-.5*f);a=t.convert(e+.5*f);c>a&&(p=c,c=a,a=p);wjcChart._DataInfo.isValid(o)&&wjcChart._DataInfo.isValid(s)&&(o=i.convert(o),s=i.convert(s),l=Math.min(o,s),v=l+Math.abs(o-s),n.drawRect(c,l,a-c,v-l),y=new wjcChart._RectArea(new wjcCore.Rect(c,l,a-c,v-l)),y.tag=h,this.hitTester.add(y,r))},t.prototype._getDataPoint=function(n,t,i,r){var f=t,u=new wjcChart._DataPoint(n,t,f,r),e=i._getItem(this._rangeValues[t].pointIndex),o=i.bindingX||this.chart.bindingX,s=i._getBinding(0),h=i._getBinding(1),c=i._getBinding(2),l=i._getBinding(3),a=i._getAxisY();return u.item=wjcChart._BasePlotter.cloneStyle(e,[]),u.item[s]=this._rangeValues[t].high,u.item[h]=this._rangeValues[t].low,u.item[c]=this._rangeValues[t].open,u.item[l]=this._rangeValues[t].close,u.y=this._rangeValues[t].close,u.yfmt=a._formatValue(this._rangeValues[t].close),u.x=u.item[o],u.xfmt=this._rangeXLabels[t]._text,u},t.prototype._init=function(){this._rangeValues=[];this._rangeXLabels=[]},t.prototype._calculate=function(){},t.prototype._generateXLabels=function(n){var r=this,t,u=n._getAxisX(),i=n.getDataType(1)||this.chart._xDataType;this._rangeValues.forEach(function(n,f){var e=n.x;t=i===wjcCore.DataType.Date?wjcCore.Globalize.format(wjcChart.FlexChart._fromOADate(e),u.format||"d"):i===wjcCore.DataType.Number?u._formatValue(e):(i===null||i===wjcCore.DataType.String)&&r.chart._xlabels?r.chart._xlabels[e]:e.toString();r._rangeXLabels.push({value:f,text:t,_text:t})},this)},t.prototype.getOption=function(n,t){var i=this.chart.options;return(t&&(i=i?i[t]:null),i&&!wjcCore.isUndefined(i[n])&&i[n]!==null)?i[n]:undefined},t}(wjcChart._BasePlotter);exports._BaseRangePlotter=_BaseRangePlotter,function(n){n[n.Close=0]="Close";n[n.High=1]="High";n[n.Low=2]="Low";n[n.Open=3]="Open";n[n.HighLow=4]="HighLow";n[n.HL2=5]="HL2";n[n.HLC3=6]="HLC3";n[n.HLOC4=7]="HLOC4"}(exports.DataFields||(exports.DataFields={}));DataFields=exports.DataFields,function(n){n[n.Fixed=0]="Fixed";n[n.ATR=1]="ATR";n[n.Percentage=2]="Percentage"}(exports.RangeMode||(exports.RangeMode={}));RangeMode=exports.RangeMode;_LineBreakPlotter=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.clear=function(){n.prototype.clear.call(this);this._newLineBreaks=null},t.prototype._calculate=function(n){this._init();var t=n._getBindingValues(3),i=n.getValues(1)||this.chart._xvals;this._calculator=new _LineBreakCalculator(null,null,null,t,i,this._newLineBreaks);this._rangeValues=this._calculator.calculate();(this._rangeValues===null||wjcCore.isUndefined(this._rangeValues))&&(this._rangeValues=[]);this._generateXLabels(n)},t.prototype._init=function(){n.prototype._init.call(this);this._newLineBreaks=wjcCore.asInt(this.getNumOption("newLineBreaks","lineBreak"),!0,!0)||3;wjcCore.assert(this._newLineBreaks>=1,"Value must be greater than 1")},t}(_BaseRangePlotter);exports._LineBreakPlotter=_LineBreakPlotter;_RenkoPlotter=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype.clear=function(){n.prototype.clear.call(this);this._boxSize=null;this._rangeMode=null},t.prototype._calculate=function(n){this._init();var t=n._getBindingValues(0),i=n._getBindingValues(1),r=n._getBindingValues(2),u=n._getBindingValues(3),f=n.getValues(1)||this.chart._xvals;this._calculator=new _RenkoCalculator(t,i,r,u,f,this._boxSize,this._rangeMode,this._fields,this._rounding);this._rangeValues=this._calculator.calculate();(this._rangeValues===null||wjcCore.isUndefined(this._rangeValues))&&(this._rangeValues=[]);this._generateXLabels(n)},t.prototype._init=function(){n.prototype._init.call(this);this._boxSize=this.getNumOption("boxSize","renko")||14;this._rangeMode=this.getOption("rangeMode","renko")||RangeMode.Fixed;this._rangeMode=wjcCore.asEnum(this._rangeMode,RangeMode,!0);wjcCore.assert(this._rangeMode!==RangeMode.Percentage,"RangeMode.Percentage is not supported");this._fields=this.getOption("fields","renko")||DataFields.Close;this._fields=wjcCore.asEnum(this._fields,DataFields,!0);wjcCore.assert(this._fields!==DataFields.HighLow,"DataFields.HighLow is not supported");this._rounding=wjcCore.asBoolean(this.getOption("rounding","renko"),!0)},t.prototype._generateXLabels=function(t){var i=this;n.prototype._generateXLabels.call(this,t);this._rangeXLabels.forEach(function(n,t){t>0&&i._rangeXLabels[t-1]._text===n.text&&(n.text="")},this)},t}(_BaseRangePlotter);exports._RenkoPlotter=_RenkoPlotter;_KagiPlotter=function(n){function t(){n.call(this)}return __extends(t,n),t.prototype._calculate=function(n){this._init();var t=n._getBindingValues(0),i=n._getBindingValues(1),r=n._getBindingValues(2),u=n._getBindingValues(3),f=n.getValues(1)||this.chart._xvals;this._calculator=new _KagiCalculator(t,i,r,u,f,this._reversalAmount,this._rangeMode,this._fields);this._rangeValues=this._calculator.calculate();(this._rangeValues===null||wjcCore.isUndefined(this._rangeValues))&&(this._rangeValues=[]);this._generateXLabels(n)},t.prototype.plotSeries=function(n,t,i,r){var p,u,e,f,h,c,w,d,o;this._calculate(r);var l=this.chart.series.indexOf(r),b=this._rangeValues.length,g=t.actualMin,nt=t.actualMax,s=this._DEFAULT_WIDTH,a=r._getSymbolStroke(l),k=r._getAltSymbolStroke(l)||a,v=[],y=[];for(n.stroke=a,n.strokeWidth=s,p=0,n.startGroup(),o=0;o<b;o++)u=o,wjcChart._DataInfo.isValid(u)&&g<=u&&u<=nt&&(e=this._rangeValues[o].open,f=this._rangeValues[o].close,o===0?(h=Math.min(e,f),c=Math.max(e,f),n.strokeWidth=e>f?s:s*2,n.stroke=e>f?a:k,n.drawLine(t.convert(u),i.convert(e),t.convert(u),i.convert(f)),n.drawLine(t.convert(u-1)-n.strokeWidth/2,i.convert(e),t.convert(u)+n.strokeWidth/2,i.convert(e))):n.strokeWidth===s?f>e?(f>c?(n.drawLine(t.convert(u),i.convert(e),t.convert(u),i.convert(c)),n.strokeWidth=s*2,n.stroke=k,n.drawLine(t.convert(u),i.convert(c),t.convert(u),i.convert(f)),h=e):n.drawLine(t.convert(u),i.convert(e),t.convert(u),i.convert(f)),c=f):n.drawLine(t.convert(u),i.convert(e),t.convert(u),i.convert(f)):n.strokeWidth/2===s&&(f<e?(f<h?(n.drawLine(t.convert(u),i.convert(e),t.convert(u),i.convert(h)),n.strokeWidth=s,n.stroke=a,n.drawLine(t.convert(u),i.convert(h),t.convert(u),i.convert(f)),c=e):n.drawLine(t.convert(u),i.convert(e),t.convert(u),i.convert(f)),h=f):n.drawLine(t.convert(u),i.convert(e),t.convert(u),i.convert(f))),o<b-1&&n.drawLine(t.convert(u)-n.strokeWidth/2,i.convert(f),t.convert(u+1)+n.strokeWidth/2,i.convert(f)),d=this._getDataPoint(l,o,r,f),w=new wjcChart._CircleArea(new wjcCore.Point(t.convert(u),i.convert(f)),.5*n.strokeWidth),w.tag=d,this.hitTester.add(w,l),r._setPointIndex(o,p),p++,v.push(t.convert(u)),y.push(i.convert(e)),v.push(t.convert(u)),y.push(i.convert(f)));n.endGroup();this.hitTester.add(new wjcChart._LinesArea(v,y),l)},t.prototype._init=function(){n.prototype._init.call(this);this._reversalAmount=this.getNumOption("reversalAmount","kagi")||14;this._rangeMode=this.getOption("rangeMode","kagi")||RangeMode.Fixed;this._rangeMode=wjcCore.asEnum(this._rangeMode,RangeMode,!0);this._fields=this.getOption("fields","kagi")||DataFields.Close;this._fields=wjcCore.asEnum(this._fields,DataFields,!0)},t.prototype.clear=function(){n.prototype.clear.call(this);this._reversalAmount=null;this._rangeMode=null},t}(_BaseRangePlotter);exports._KagiPlotter=_KagiPlotter